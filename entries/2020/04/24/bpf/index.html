<!DOCTYPE html>
<html lang="en">
<head>
    <title>TIL - BPF</title>

  <link rel="stylesheet" href="https://til.grayvines.com/theme/css/main.css" />
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css" rel="stylesheet" type="text/css">

  <meta charset="utf-8" />
  <link href="https://til.grayvines.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="TIL Full Atom Feed" />
  <link href="https://til.grayvines.com/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate" title="TIL Categories Atom Feed" />






</head>

<body>

  <header id="site-header">
    <div class="container">
      <a href="https://til.grayvines.com/"><h1 class="blog-title">TIL</h1></a>
      <p class="blog-description">Today I Learned</p>
    </div>

<nav id="menu"><ul>


      <li><a href="https://til.grayvines.com/categories/design/">design</a></li>
      <li><a href="https://til.grayvines.com/categories/food/">food</a></li>
      <li><a href="https://til.grayvines.com/categories/health/">health</a></li>
      <li><a href="https://til.grayvines.com/categories/history/">history</a></li>
      <li><a href="https://til.grayvines.com/categories/language/">language</a></li>
      <li><a href="https://til.grayvines.com/categories/math/">math</a></li>
      <li><a href="https://til.grayvines.com/categories/misc/">misc</a></li>
      <li><a href="https://til.grayvines.com/categories/music/">music</a></li>
      <li><a href="https://til.grayvines.com/categories/physics/">physics</a></li>
      <li class="active"><a href="https://til.grayvines.com/categories/programming/">programming</a></li>
      <li><a href="https://til.grayvines.com/categories/sports/">sports</a></li>
      <li><a href="https://til.grayvines.com/categories/travel/">travel</a></li>
</ul></nav><!-- /#menu -->  </header><!-- /#site-header -->


<main class="content" role="main">
  <div class="container">
    <article class="entry">
      <header class="entry-header">
        <h3 class="p-entry-title">
          <a href="https://til.grayvines.com/entries/2020/04/24/bpf/" rel="bookmark" title="Permalink to BPF">
            <span class="caps">BPF</span>
          </a>
        </h3>

        <p class="entry-time">
          <time class="published" datetime="2020-04-24T00:51:27-04:00">
            April 24, 2020
          </time>
        </p>
    
      </header>

      <section class="entry-content">
        <div class="section" id="jit">
<h4><span class="caps">JIT</span></h4>
<p>A restricted subset of C is compiled via <tt class="docutils literal">clang</tt> to eBPF bytecode, and the
Linux kernel contains a <span class="caps">JIT</span> (and of course a <span class="caps">VM</span>) to execute&nbsp;it.</p>
</div>
<div class="section" id="bcc">
<h4><tt class="docutils literal">bcc</tt></h4>
<p><a class="reference external" href="https://github.com/iovisor/bcc">bcc</a> is a higher level toolkit for
interacting with eBPF (including via Python). For&nbsp;example:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bcc</span> <span class="kn">import</span> <span class="n">BPF</span>

<span class="n">BPF</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        int kprobe__sys_clone(void *ctx) {</span>
<span class="s2">            bpf_trace_printk(&quot;Hello, World!</span><span class="se">\\</span><span class="s2">n&quot;);</span>
<span class="s2">            return 0;</span>
<span class="s2">        }</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">trace_print</span><span class="p">()</span>
</pre></div>
<p>will attach a simple print callback whenever a new process is spawned (via
<tt class="docutils literal">clone(2)</tt>).</p>
</div>
<div class="section" id="bpf-based-tools">
<h4><span class="caps">BPF</span>-based&nbsp;tools</h4>
<p>Brendan Gregg has a great <a class="reference external" href="http://www.brendangregg.com/ebpf.html">diagram and post</a> of the various <span class="caps">BPF</span>-using
tools, and which part of the stack they&nbsp;trace.</p>
</div>
<div class="section" id="more-tracing">
<h4>More&nbsp;Tracing</h4>
<p>Julia Evans&#8217;s <a class="reference external" href="https://jvns.ca/blog/2017/07/05/linux-tracing-systems/">Linux tracing systems <span class="amp">&amp;</span> how they fit together</a> is pretty great
reading <span class="amp">&amp;</span> reference for context beyond just <span class="caps">BPF</span>.</p>
</div>

      </section><!-- /.entry-content -->

      <hr>

      <footer class="entry-footer">
        <section class="f-1">
          <section class="f-entry-time">
              <time class="published" datetime="2020-04-24T00:51:27-04:00">
                April 24, 2020
              </time>
          </section>
          <p class="f-entry-time">
            <time class="modified" datetime="2020-05-30T15:21:31-04:00">
              Modified on May 30, 2020
            </time>
          </p>
        </section>

        <section class="f-2">
          <div class="category">
              Category: <a href="https://til.grayvines.com/categories/programming/">programming</a>
          </div>
        </section>
      </footer><!-- /.entry-info -->
    </article>
  </div>
</main>

<footer id="site-footer" class="body">
  <div class="container">
    <a href="https://github.com/Julian" target="_blank">
      <span class="tooltip"><i class="fab fa-github"></i></span>
    </a>
    <a href="https://instagram.com/julianberman" target="_blank">
      <span class="tooltip"><i class="fab fa-instagram"></i></span>
    </a>
    <a href="https://mastodon.social/@JulianWasTaken" target="_blank">
      <span class="tooltip"><i class="fab fa-mastodon"></i></span>
    </a>
    <a href="https://photos.grayvines.com/" target="_blank">
      <span class="tooltip"><i class="fab fa-photos"></i></span>
    </a>


    <section>&copy; <a href="https://github.com/Julian">Julian Berman</a> 2020</section>
    <section>Theme modified from <a href="http://www.jrdnbwmn.com">Detox by Jordan Bowman</a>. Generated with <a href="https://getpelican.com">Pelican</a>.</section>
  </div>
</footer>
</body>
</html>